<div class="confirmation-container">
  <!-- Loading Spinner -->
  <mat-spinner *ngIf="isLoading" diameter="50"></mat-spinner>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    <mat-icon>error</mat-icon>
    {{ errorMessage }}
    <button mat-raised-button color="primary" (click)="startNewBooking()">New Booking</button>
  </div>

  <!-- Success Confirmation (if booking exists) -->
  <div *ngIf="booking && !errorMessage" class="success-container">
    <mat-card class="booking-card">
      <mat-card-header>
        <mat-card-title>Booking Confirmed!</mat-card-title>
        <mat-card-subtitle>Booking ID: {{ booking.id }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="summary-section">
          <h3>Flight Details</h3>
          <p><strong>Airline:</strong> {{ booking.flight?.airline }} - {{ booking.flight?.flightNumber }}</p>
          <p><strong>Route:</strong> {{ booking.flight?.fromAirport }} → {{ booking.flight?.toAirport }}</p>
          <p><strong>Date & Time:</strong> {{ booking.flight?.date }} | Dep: {{ booking.flight?.departureTime }} | Arr: {{ booking.flight?.arrivalTime }}</p>
          <p><strong>Duration:</strong> {{ booking.flight?.duration }} | <strong>Seats:</strong> {{ booking.flight?.seatsAvailable }}</p>
          <p><strong>Flight Price:</strong> ₹{{ booking.flight?.price }}</p>
        </div>

        <div class="summary-section">
          <h3>Pickup & Drop</h3>
          <p><strong>Pickup:</strong> {{ booking.pickupLocation?.name || 'N/A' }} via {{ booking.pickupMode }} (₹{{ booking.pickupPrice || 0 }})</p>
          <p><strong>Drop:</strong> {{ booking.dropLocation?.name || 'N/A' }} via {{ booking.dropMode }} (₹{{ booking.dropPrice || 0 }})</p>
        </div>

        <div class="summary-section">
          <h3>Extras & Ancillaries</h3>
          <p><strong>Seat Type:</strong> {{ booking.seatType }} (₹{{ booking.seatPrice || 0 }})</p>
          <p><strong>Ancillaries:</strong> {{ (booking.ancillaries || []).join(', ') || 'None' }} (₹{{ booking.ancillaryPrice || 0 }})</p>
        </div>

        <div class="total-section">
          <h3>Total Amount: ₹{{ totalPrice }}</h3>
          <p><em>Status: {{ booking.status.toUpperCase() }}</em></p>
          <p><strong>Payment ID:</strong> {{ booking.paymentId }}</p>
        </div>
      </mat-card-content>
      <mat-card-actions align="end">
        <button mat-raised-button color="primary" (click)="openReceiptDialog()" [disabled]="isLoading">
          <mat-icon>receipt</mat-icon> View Receipt
        </button>
        <button mat-button color="accent" (click)="startNewBooking()">
          New Booking
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>